import{j as e,v as O,b6 as R,D as W,aa as B,J as G,U as F,aj as X}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e10.js";import{a as x}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e4.js";import{p as J,F as Q}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e5.js";import{u as V}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e32.js";import{u as q,c as K}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e19.js";import{n as Y,Q as Z,aI as ee}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e22.js";import{A as te}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e200.js";import{M as ae}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e145.js";import{W as b}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e18.js";import{a as se}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e107.js";import{U as re}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e61.js";import{a as le,b as ie,d as ne}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e163.js";import{a as oe}from"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e75.js";import"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e8.js";import"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e.js";import"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e7.js";import"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e6.js";import"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e2.js";import"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e3.js";import"./v_7_4_0_1_4b8cc392-a410-45f6-b662-85abdad9c03e9.js";function ce({userId:n,name:m}){const{agendamentosNaoDisparados:c,removeAgendamento:v,enviarAgendamento:N,buttonActive:l,openUserChat:y,setButtonActive:w,agendamentos:A}=V(),[o,D]=x.useState(l?c:c.filter(s=>s.userID===n)),{language:t}=q(),{plugin_page:I}=K(),[C,M]=x.useState(new Map),T=async s=>{const r=await b.Contact("getProfilePictureUrl",s),{name:a}=await b.Utils("getContato",s);return{nome:a,base64:r}},E=async s=>{const r=Array.from(new Set(s.map(i=>i.userID))),a=new Map;for(const i of r){const d=await T(i);a.set(i,d)}M(a)};x.useEffect(()=>{E(o)},[o]);const p=s=>C.get(s)||{nome:"",base64:""};x.useEffect(()=>{const s=new Date().getTime(),a=(l?c:c.filter(i=>i.userID===n)).sort((i,d)=>{const z=new Date(`${i.data}T${i.hora}:00`).getTime(),L=new Date(`${d.data}T${d.hora}:00`).getTime(),$=Math.abs(z-s),P=Math.abs(L-s);return $-P});D(a)},[c,l,n,A]);const{open:f}=Y(),h=50,g=37,u="calc(85vh - 300px)",k=()=>{const s=o.length*h+g,r=parseInt(u.replace(/[^\d]/g,""));return Math.min(s,r)},_=s=>{f(e.jsx(te,{agendamento:s,create:!1,userId:n,name:m,tipo:"relatorio"}))},j=()=>{f(e.jsx(ae,{userId:n,name:m}))},H=s=>{y(s.userID),f(e.jsx(ce,{userId:s.userID,name:m}))},S=({index:s,style:r})=>{const a=o[s];return e.jsxs("div",{style:r,className:"flex items-center hover:bg-base-200 rounded-lg cursor-pointer h-full border-solid border-b border-[var(--border-list)] last-of-type:border-none",children:[e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("span",{className:"break-words truncate",style:{maxWidth:"100px"},children:a.titulo})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[p(a.userID).base64==="undefined"?e.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center",children:e.jsx(re,{})}):e.jsx("img",{src:p(a.userID).base64,className:"w-8 h-8 rounded-full object-cover",alt:"User"}),e.jsx("p",{className:"break-words truncate",style:{maxWidth:"92px"},children:p(a.userID).nome})]})}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.tipo}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:F.converterData(a.data)}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.hora}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.recorrenciaManual?a.recorrencia?`${a.recorrencia} ${t.dias}`:t.vazia:t[a.recorrencia]||t.vazia}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx("span",{className:"break-words truncate",style:{maxWidth:"100px"},children:a.status==="enviado"?e.jsx("div",{className:"badge badge-accent text-[var(--letra)]",children:t.agenEnviado}):e.jsx("div",{className:"badge badge-error text-[var(--letra)]",children:t.agenErro})})}),e.jsxs("div",{className:"flex-1 flex items-center justify-center gap-1",children:[e.jsx("span",{className:"pulse",onClick:()=>_(a),children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx("span",{className:"pulse",onClick:()=>v(a.id,"relatorio"),children:e.jsx(se,{className:"h-4 w-4"})}),e.jsx("span",{className:"pulse lg:tooltip lg:tooltip-bottom",onClick:()=>N(a),"data-tip":t.enviar,children:e.jsx(ne,{className:"h-4 w-4"})}),l&&n!==a.userID&&!I&&e.jsx("span",{className:"pulse lg:tooltip lg:tooltip-left",onClick:()=>H(a),"data-tip":t.agenOpenChat,children:e.jsx(ee,{className:"h-4 w-4"})})]})]},a.id)},U=()=>e.jsx("div",{className:"w-full border-collapse",children:e.jsxs("div",{className:"flex font-bold",children:[e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_titulo}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_cliente}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_tipo}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_data}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_hora}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_recorrencia}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.status}),e.jsx("div",{className:"flex-1 px-4 py-3 text-xs align-middle text-center table-cell text-[#1f293799] dark:text-[#a6adbb99]",children:t.agendamento_table_acao})]})});return e.jsxs("div",{className:"grid gap-4",style:{maxHeight:"90vh",width:"950px"},children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"w-full flex items-center justify-between pr-2",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(O,{children:t.relatorioTitle}),e.jsx("div",{className:"cursor-pointer lg:tooltip lg:tooltip-bottom tooltip-w-fit","data-tip":t.relInfoDesc,children:e.jsx("span",{className:"pulse   before:!w-44 mt-1.5",children:e.jsx(R,{className:"w-5 h-5 text-[var(--icon)]"})})}),e.jsx("div",{className:"cursor-pointer lg:tooltip lg:tooltip-right","data-tip":t.voltar,onClick:j,children:e.jsx("span",{className:"pulse",children:e.jsx(oe,{className:"w-6 h-6 text-[var(--primaria)]"})})})]}),e.jsx("button",{className:`border-solid border-[var(--primary)] border rounded-full text-center
            ${l?"bg-[var(--primary-muted)] text-white":"bg-transparent text-[var(--primary)]"}
            self-center px-3 py-[4px] pulse lg:tooltip lg:tooltip-bottom text-sm transition-all duration-300 ease-in`,onClick:()=>w(!l),"data-tip":l?t.ocultarContatosDesc:t.exibirContatosDesc,children:e.jsxs("span",{className:"inline-flex items-center gap-0.5",children:[l?t.ocultar:t.exibirTodos,l?e.jsx(le,{}):e.jsx(ie,{})]})})]}),e.jsx(W,{children:"Exibe o relatório dos últimos 30 envios realizados"})]}),e.jsx("div",{children:o.length>0?e.jsxs("div",{style:{height:k(),maxHeight:u,width:"100%"},children:[e.jsx(U,{}),e.jsx(J,{children:({height:s,width:r})=>e.jsx(Q,{height:s-g,itemCount:o.length,itemSize:h,width:r,style:{overflowX:"hidden",width:r},children:S})})]}):e.jsx("div",{className:"!h-fit",children:e.jsx(B,{title:t.relNenhumAgendamentoErro,description:t.relDescricaoAgendamentos,icon:e.jsx(Z,{className:"w-7 h-7 text-[var(--primaria)]"})})})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(G,{name:t.voltar,funcao:j})})]})}export{ce as default};
